<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Owner Dashboard</title>
    <link rel="stylesheet" href="../css/main.css">
</head>
<body class="dashboard">
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-content">
            <a href="#" class="nav-brand">School System</a>
            <ul class="nav-menu">
                <li><a href="#overview">Overview</a></li>
                <li><a href="#schools">Schools</a></li>
                <li><a href="#users">Users</a></li>
                <li><a href="#settings">Settings</a></li>
            </ul>
            <div class="nav-user">
                <span class="user-badge" id="userRole">System Owner</span>
                <span id="userName">Loading...</span>
                <button id="logoutBtn" class="btn btn-danger">Logout</button>
            </div>
        </div>
    </nav>
    
    <!-- Dashboard Content -->
    <div class="dashboard-content">
        <div class="container">
            <h1>System Owner Dashboard</h1>
            <p>Manage all schools, users, and system-wide settings</p>
            
            <!-- Statistics -->
            <div class="stats-container" id="statsContainer">
                <div class="stat-card">
                    <div class="stat-icon">üè´</div>
                    <div class="stat-info">
                        <h3 id="totalSchools">0</h3>
                        <p>Total Schools</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üë•</div>
                    <div class="stat-info">
                        <h3 id="totalUsers">0</h3>
                        <p>Total Users</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üë®‚Äçüéì</div>
                    <div class="stat-info">
                        <h3 id="totalStudents">0</h3>
                        <p>Total Students</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üë®‚Äçüè´</div>
                    <div class="stat-info">
                        <h3 id="totalTeachers">0</h3>
                        <p>Total Teachers</p>
                    </div>
                </div>
            </div>
            
            <!-- Schools List -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Schools Management</h2>
                </div>
                <div class="table-container" id="schoolsTable">
                    <p>Loading schools...</p>
                </div>
            </div>
            
            <!-- Recent Users -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Recent Users</h2>
                </div>
                <div class="table-container" id="usersTable">
                    <p>Loading users...</p>
                </div>
            </div>
        </div>
    </div>
    
    <script src="../js/utils.js"></script>
    <script src="../js/api.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/dashboard.js"></script>
    <script>
        // System Owner Dashboard Script
        document.addEventListener('DOMContentLoaded', async function() {
            // Initialize dashboard
            Dashboard.init(Auth.ROLES.SYSTEM_OWNER);
            
            // Load statistics
            loadStatistics();
            
            // Load schools
            loadSchools();
            
            // Load recent users
            loadUsers();
        });
        
        async function loadStatistics() {
            try {
                // In a real implementation, these would be API calls
                // For now, using placeholder data
                document.getElementById('totalSchools').textContent = '12';
                document.getElementById('totalUsers').textContent = '450';
                document.getElementById('totalStudents').textContent = '325';
                document.getElementById('totalTeachers').textContent = '48';
            } catch (error) {
                console.error('Error loading statistics:', error);
            }
        }
        
        async function loadSchools() {
            const container = document.getElementById('schoolsTable');
            
            try {
                // Placeholder data - replace with actual API call
                const schools = [
                    { id: 1, name: 'Springfield Elementary', admin: 'John Doe', students: 150, status: 'Active' },
                    { id: 2, name: 'Riverdale High', admin: 'Jane Smith', students: 200, status: 'Active' },
                    { id: 3, name: 'Greenwood Academy', admin: 'Bob Johnson', students: 120, status: 'Active' }
                ];
                
                const columns = [
                    { label: 'School Name', field: 'name' },
                    { label: 'Admin', field: 'admin' },
                    { label: 'Students', field: 'students' },
                    { label: 'Status', field: 'status' }
                ];
                
                container.innerHTML = Dashboard.renderTable(columns, schools);
            } catch (error) {
                console.error('Error loading schools:', error);
                container.innerHTML = '<p class="error-message">Failed to load schools</p>';
            }
        }
        
        async function loadUsers() {
            const container = document.getElementById('usersTable');
            
            try {
                // Placeholder data - replace with actual API call
                const users = [
                    { name: 'Alice Williams', role: 'Teacher', email: 'alice@example.com', joined: '2024-01-15' },
                    { name: 'Bob Brown', role: 'Parent', email: 'bob@example.com', joined: '2024-02-01' },
                    { name: 'Charlie Davis', role: 'Student', email: 'charlie@example.com', joined: '2024-02-10' }
                ];
                
                const columns = [
                    { label: 'Name', field: 'name' },
                    { label: 'Role', field: 'role' },
                    { label: 'Email', field: 'email' },
                    { label: 'Joined', field: 'joined', render: (row) => formatDate(row.joined) }
                ];
                
                container.innerHTML = Dashboard.renderTable(columns, users);
            } catch (error) {
                console.error('Error loading users:', error);
                container.innerHTML = '<p class="error-message">Failed to load users</p>';
            }
        }
    </script>
</body>
</html>
